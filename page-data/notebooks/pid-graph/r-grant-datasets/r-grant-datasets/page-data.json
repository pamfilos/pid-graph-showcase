{"componentChunkName":"component---src-templates-notebook-js","path":"/notebooks/pid-graph/r-grant-datasets/r-grant-datasets/","result":{"data":{"jupyterNotebook":{"html":"<div class=\"notebook-render\"><div class=\"sc-iwsKbI Dticx\"><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><h1>PID Graph for datasets related to FREYA</h1>\n<p>This notebook uses the <a>DataCite GraphQL API</a> to fetch all connections to a publication with a DataCite DOI.</p>\n<h2>Prepare the R GraphQl client</h2>\n<p>Load necessary libraries and set up the API endpoint.</p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[66]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">library<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;httr&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nlibrary<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;ghql&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nlibrary<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;jsonlite&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nlibrary<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;IRdisplay&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nlibrary<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;dplyr&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nlibrary<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;purrr&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nlibrary<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;igraph&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\ncli <span class=\"token\" style=\"color:#393A34\">&lt;-</span> GraphqlClient<span class=\"token\" style=\"color:#393A34\">$</span>new<span class=\"token\" style=\"color:#393A34\">(</span>\n  url <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;https://api.datacite.org/graphql&quot;</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\nqry <span class=\"token\" style=\"color:#393A34\">&lt;-</span> Query<span class=\"token\" style=\"color:#393A34\">$</span>new<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><h2>Generate the GraphQL query</h2>\n<p>In this query, we are looking through all DataCite DOIs that are assigned to datasets and finding those that include the FREYA grant number within a funding reference. </p>\n<p>Then for each of those datasets, we&#x27;re asking for:</p>\n<ol>\n<li>identifiers for the creators (in this case ORCID IDs)</li>\n<li>identifiers for items related to that dataset (citations, versions, etc.)</li>\n<li>identifiers for any funders related to that dataset</li>\n</ol>\n<p>In this example, we already know that the datasets will have the EC as a related funder, but pulling in the <code>funderIdentifier</code> will allow us to plot that information as part of our graph.</p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[67]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">query <span class=\"token\" style=\"color:#393A34\">&lt;-</span> &#x27;<span class=\"token\" style=\"color:#393A34\">{</span>\n  datasets<span class=\"token\" style=\"color:#393A34\">(</span>query<span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;fundingReferences.awardNumber:777523&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">{</span>\n    totalCount\n    nodes <span class=\"token\" style=\"color:#393A34\">{</span>\n      id\n      creators <span class=\"token\" style=\"color:#393A34\">{</span>\n        id\n      <span class=\"token\" style=\"color:#393A34\">}</span>\n      publications <span class=\"token\" style=\"color:#393A34\">{</span>\n        nodes <span class=\"token\" style=\"color:#393A34\">{</span>\n          id\n        <span class=\"token\" style=\"color:#393A34\">}</span>\n      <span class=\"token\" style=\"color:#393A34\">}</span>\n      datasets <span class=\"token\" style=\"color:#393A34\">{</span>\n        nodes <span class=\"token\" style=\"color:#393A34\">{</span>\n          id\n        <span class=\"token\" style=\"color:#393A34\">}</span>\n      <span class=\"token\" style=\"color:#393A34\">}</span>\n      fundingReferences <span class=\"token\" style=\"color:#393A34\">{</span>\n        funderIdentifier\n      <span class=\"token\" style=\"color:#393A34\">}</span>\n    <span class=\"token\" style=\"color:#393A34\">}</span>\n  <span class=\"token\" style=\"color:#393A34\">}</span>\n<span class=\"token\" style=\"color:#393A34\">}</span>&#x27;</code></pre></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><h2>Run the query</h2>\n<p>We&#x27;ll run the query and process the JSON response it returns.</p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[68]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">qry<span class=\"token\" style=\"color:#393A34\">$</span>query<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;getdata&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> query<span class=\"token\" style=\"color:#393A34\">)</span>\ndata <span class=\"token\" style=\"color:#393A34\">&lt;-</span> fromJSON<span class=\"token\" style=\"color:#393A34\">(</span>cli<span class=\"token\" style=\"color:#393A34\">$</span>exec<span class=\"token\" style=\"color:#393A34\">(</span>qry<span class=\"token\" style=\"color:#393A34\">$</span>queries<span class=\"token\" style=\"color:#393A34\">$</span>getdata<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><h2>Display the number of datasets</h2>\n<p>This step is just to check our work. We already know there should be only 2 matching datasets (as of 6 June 2019 when this notebook was first created). </p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[69]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">display_json<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">$</span>data<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>totalCount<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-gzVnrw jFzGrB\"></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><p>Now let&#x27;s prepare the data frame. We&#x27;re defining what all of the nodes are for our graph. </p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[70]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">datasets <span class=\"token\" style=\"color:#393A34\">&lt;-</span> data.frame<span class=\"token\" style=\"color:#393A34\">(</span>id<span class=\"token\" style=\"color:#393A34\">=</span>map<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">$</span>data<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">$</span>id<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">~</span> discard<span class=\"token\" style=\"color:#393A34\">(</span>.x<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">~</span> is.na<span class=\"token\" style=\"color:#393A34\">(</span>.x<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> pid_type<span class=\"token\" style=\"color:#393A34\">=</span>c<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dataset&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nresearchers <span class=\"token\" style=\"color:#393A34\">&lt;-</span> data.frame<span class=\"token\" style=\"color:#393A34\">(</span>id<span class=\"token\" style=\"color:#393A34\">=</span>bind_rows<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">$</span>data<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">$</span>creators<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> pid_type<span class=\"token\" style=\"color:#393A34\">=</span>c<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;researcher&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nreferences <span class=\"token\" style=\"color:#393A34\">&lt;-</span> data.frame<span class=\"token\" style=\"color:#393A34\">(</span>id<span class=\"token\" style=\"color:#393A34\">=</span>bind_rows<span class=\"token\" style=\"color:#393A34\">(</span>map<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">$</span>data<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">$</span>publications<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">$</span>id<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">~</span> discard<span class=\"token\" style=\"color:#393A34\">(</span>.x<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">~</span> is.na<span class=\"token\" style=\"color:#393A34\">(</span>.x<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> pid_type<span class=\"token\" style=\"color:#393A34\">=</span>c<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;publication&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndataset_references <span class=\"token\" style=\"color:#393A34\">&lt;-</span> data.frame<span class=\"token\" style=\"color:#393A34\">(</span>id<span class=\"token\" style=\"color:#393A34\">=</span>bind_rows<span class=\"token\" style=\"color:#393A34\">(</span>map<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">$</span>data<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">$</span>id<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">~</span> discard<span class=\"token\" style=\"color:#393A34\">(</span>.x<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">~</span> is.na<span class=\"token\" style=\"color:#393A34\">(</span>.x<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> pid_type<span class=\"token\" style=\"color:#393A34\">=</span>c<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dataset&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nfunders <span class=\"token\" style=\"color:#393A34\">&lt;-</span> data.frame<span class=\"token\" style=\"color:#393A34\">(</span>id<span class=\"token\" style=\"color:#393A34\">=</span>bind_rows<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">$</span>data<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">$</span>fundingReferences<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> pid_type<span class=\"token\" style=\"color:#393A34\">=</span>c<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;funder&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nnodes <span class=\"token\" style=\"color:#393A34\">&lt;-</span> unique<span class=\"token\" style=\"color:#393A34\">(</span>rbind<span class=\"token\" style=\"color:#393A34\">(</span>datasets<span class=\"token\" style=\"color:#393A34\">,</span> researchers<span class=\"token\" style=\"color:#393A34\">,</span> references<span class=\"token\" style=\"color:#393A34\">,</span> dataset_references<span class=\"token\" style=\"color:#393A34\">,</span> funders<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\nnodes <span class=\"token\" style=\"color:#393A34\">&lt;-</span> nodes <span class=\"token,percent-operator\" style=\"color:#393A34\">%&gt;%</span> filter<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">!</span>is.na<span class=\"token\" style=\"color:#393A34\">(</span>as.character<span class=\"token\" style=\"color:#393A34\">(</span>id<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token,percent-operator\" style=\"color:#393A34\">%&gt;%</span> mutate<span class=\"token\" style=\"color:#393A34\">(</span>id <span class=\"token\" style=\"color:#393A34\">=</span> ifelse<span class=\"token\" style=\"color:#393A34\">(</span>startsWith<span class=\"token\" style=\"color:#393A34\">(</span>as.character<span class=\"token\" style=\"color:#393A34\">(</span>id<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;10.&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> paste<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;https://doi.org/&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> id<span class=\"token\" style=\"color:#393A34\">,</span> sep<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> as.character<span class=\"token\" style=\"color:#393A34\">(</span>id<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># remove duplicates</span>\nnodes <span class=\"token\" style=\"color:#393A34\">&lt;-</span> nodes <span class=\"token,percent-operator\" style=\"color:#393A34\">%&gt;%</span> distinct<span class=\"token\" style=\"color:#393A34\">(</span>id<span class=\"token\" style=\"color:#393A34\">,</span> .keep_all <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">TRUE</span><span class=\"token\" style=\"color:#393A34\">)</span>\nnodes</code></pre></div><div class=\"sc-gzVnrw jFzGrB\"></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><p>Then we define the edges for our graph. We loop through the nodes because each node could have multiple edges.</p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[ ]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">edges <span class=\"token\" style=\"color:#393A34\">&lt;-</span> data.frame<span class=\"token\" style=\"color:#393A34\">(</span>to<span class=\"token\" style=\"color:#393A34\">=</span>character<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> from<span class=\"token\" style=\"color:#393A34\">=</span>character<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nnodes_with_creators <span class=\"token\" style=\"color:#393A34\">&lt;-</span> bind_rows<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">$</span>data<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token,percent-operator\" style=\"color:#393A34\">%&gt;%</span> filter<span class=\"token\" style=\"color:#393A34\">(</span>lengths<span class=\"token\" style=\"color:#393A34\">(</span>creators<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> <span class=\"token\" style=\"color:#393A34\">(</span>i <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span>nrow<span class=\"token\" style=\"color:#393A34\">(</span>nodes_with_creators<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">{</span>\n  row <span class=\"token\" style=\"color:#393A34\">&lt;-</span> data.frame<span class=\"token\" style=\"color:#393A34\">(</span>to<span class=\"token\" style=\"color:#393A34\">=</span>unlist<span class=\"token\" style=\"color:#393A34\">(</span>nodes_with_creators<span class=\"token\" style=\"color:#393A34\">[</span>i<span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> from<span class=\"token\" style=\"color:#393A34\">=</span>nodes_with_creators<span class=\"token\" style=\"color:#393A34\">[</span>i<span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\n  edges <span class=\"token\" style=\"color:#393A34\">&lt;-</span> unique<span class=\"token\" style=\"color:#393A34\">(</span>rbind<span class=\"token\" style=\"color:#393A34\">(</span>edges<span class=\"token\" style=\"color:#393A34\">,</span> row<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">}</span>\n\nnodes_with_references <span class=\"token\" style=\"color:#393A34\">&lt;-</span> bind_rows<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">$</span>data<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token,percent-operator\" style=\"color:#393A34\">%&gt;%</span> filter<span class=\"token\" style=\"color:#393A34\">(</span>lengths<span class=\"token\" style=\"color:#393A34\">(</span>relatedIdentifiers<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> <span class=\"token\" style=\"color:#393A34\">(</span>i <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span>nrow<span class=\"token\" style=\"color:#393A34\">(</span>nodes_with_references<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">{</span>\n  row <span class=\"token\" style=\"color:#393A34\">&lt;-</span> data.frame<span class=\"token\" style=\"color:#393A34\">(</span>to<span class=\"token\" style=\"color:#393A34\">=</span>unlist<span class=\"token\" style=\"color:#393A34\">(</span>nodes_with_references<span class=\"token\" style=\"color:#393A34\">[</span>i<span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">3</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> from<span class=\"token\" style=\"color:#393A34\">=</span>nodes_with_references<span class=\"token\" style=\"color:#393A34\">[</span>i<span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\n  edges <span class=\"token\" style=\"color:#393A34\">&lt;-</span> unique<span class=\"token\" style=\"color:#393A34\">(</span>rbind<span class=\"token\" style=\"color:#393A34\">(</span>edges<span class=\"token\" style=\"color:#393A34\">,</span> row<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">}</span>\n\nnodes_with_funding <span class=\"token\" style=\"color:#393A34\">&lt;-</span> bind_rows<span class=\"token\" style=\"color:#393A34\">(</span>data<span class=\"token\" style=\"color:#393A34\">$</span>data<span class=\"token\" style=\"color:#393A34\">$</span>datasets<span class=\"token\" style=\"color:#393A34\">$</span>nodes<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token,percent-operator\" style=\"color:#393A34\">%&gt;%</span> filter<span class=\"token\" style=\"color:#393A34\">(</span>lengths<span class=\"token\" style=\"color:#393A34\">(</span>fundingReferences<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> <span class=\"token\" style=\"color:#393A34\">(</span>i <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span>nrow<span class=\"token\" style=\"color:#393A34\">(</span>nodes_with_funding<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">{</span>\n  row <span class=\"token\" style=\"color:#393A34\">&lt;-</span> data.frame<span class=\"token\" style=\"color:#393A34\">(</span>to<span class=\"token\" style=\"color:#393A34\">=</span>unlist<span class=\"token\" style=\"color:#393A34\">(</span>nodes_with_funding<span class=\"token\" style=\"color:#393A34\">[</span>i<span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">4</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> from<span class=\"token\" style=\"color:#393A34\">=</span>nodes_with_funding<span class=\"token\" style=\"color:#393A34\">[</span>i<span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\n  edges <span class=\"token\" style=\"color:#393A34\">&lt;-</span> unique<span class=\"token\" style=\"color:#393A34\">(</span>rbind<span class=\"token\" style=\"color:#393A34\">(</span>edges<span class=\"token\" style=\"color:#393A34\">,</span> row<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">}</span></code></pre></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><h2>Generating the graph</h2>\n<p>We&#x27;re going to make sure that all of the DOIs we&#x27;re receiving are being expressed as URLs. This will help us with de-duping and filtering in later steps.</p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[ ]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">edges <span class=\"token\" style=\"color:#393A34\">&lt;-</span> edges <span class=\"token,percent-operator\" style=\"color:#393A34\">%&gt;%</span> filter<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">!</span>is.na<span class=\"token\" style=\"color:#393A34\">(</span>as.character<span class=\"token\" style=\"color:#393A34\">(</span>to<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token,percent-operator\" style=\"color:#393A34\">%&gt;%</span> mutate<span class=\"token\" style=\"color:#393A34\">(</span>to <span class=\"token\" style=\"color:#393A34\">=</span> ifelse<span class=\"token\" style=\"color:#393A34\">(</span>startsWith<span class=\"token\" style=\"color:#393A34\">(</span>as.character<span class=\"token\" style=\"color:#393A34\">(</span>to<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;10.&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> paste<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;https://doi.org/&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> to<span class=\"token\" style=\"color:#393A34\">,</span> sep<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> as.character<span class=\"token\" style=\"color:#393A34\">(</span>to<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><p>Next we format the graph for display. Here are the formatting choices we&#x27;re making. </p>\n<ol>\n<li>We&#x27;re going to display only the unique edges and nodes. </li>\n<li>We&#x27;re coloring datasets red, researchers green, publications blue, and funders yellow.</li>\n<li>We&#x27;re making the nodes a nice size for viewing. </li>\n<li>This is not a directed graph (<code>relatedidentifiers</code> don&#x27;t specify a relational direction), so we don&#x27;t need to have any arrows. </li>\n</ol></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[ ]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">g <span class=\"token\" style=\"color:#393A34\">&lt;-</span> graph_from_data_frame<span class=\"token\" style=\"color:#393A34\">(</span>d<span class=\"token\" style=\"color:#393A34\">=</span>unique<span class=\"token\" style=\"color:#393A34\">(</span>edges<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> vertices<span class=\"token\" style=\"color:#393A34\">=</span>unique<span class=\"token\" style=\"color:#393A34\">(</span>nodes<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># Node colors</span>\ncol <span class=\"token\" style=\"color:#393A34\">=</span> c<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;#e45718&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#A31515\">&#x27;#fecf59&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#A31515\">&#x27;#48b1f4&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#A31515\">&#x27;#53c48c&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nV<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">(</span>V<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">$</span>pid_type<span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#A31515\">&quot;publication&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">$</span>color<span class=\"token\" style=\"color:#393A34\">&lt;-</span><span class=\"token\" style=\"color:#A31515\">&#x27;#48b1f4&#x27;</span>\nV<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">(</span>V<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">$</span>pid_type<span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#A31515\">&quot;researcher&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">$</span>color<span class=\"token\" style=\"color:#393A34\">&lt;-</span><span class=\"token\" style=\"color:#A31515\">&#x27;#53c48c&#x27;</span>\nV<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">(</span>V<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">$</span>pid_type<span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#A31515\">&quot;funder&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">$</span>color<span class=\"token\" style=\"color:#393A34\">&lt;-</span><span class=\"token\" style=\"color:#A31515\">&#x27;#fecf59&#x27;</span>\nV<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">(</span>V<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">$</span>pid_type<span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#A31515\">&quot;dataset&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">$</span>color<span class=\"token\" style=\"color:#393A34\">&lt;-</span><span class=\"token\" style=\"color:#A31515\">&#x27;#e45718&#x27;</span>\n\nV<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">$</span>size <span class=\"token\" style=\"color:#393A34\">&lt;-</span> <span class=\"token\" style=\"color:#36acaa\">8</span>\nE<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">$</span>arrow.mode <span class=\"token\" style=\"color:#393A34\">&lt;-</span> <span class=\"token\" style=\"color:#36acaa\">0</span>\nl <span class=\"token\" style=\"color:#393A34\">&lt;-</span> layout_with_dh<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><p>And finally, we plot the actual graph. </p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[ ]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">plot<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">,</span> vertex.label<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#0000ff\">NA</span><span class=\"token\" style=\"color:#393A34\">,</span> layout<span class=\"token\" style=\"color:#393A34\">=</span>l<span class=\"token\" style=\"color:#393A34\">,</span> arrow.mode<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># Add a legend</span>\nlegend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;bottomleft&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> legend<span class=\"token\" style=\"color:#393A34\">=</span>levels<span class=\"token\" style=\"color:#393A34\">(</span>as.factor<span class=\"token\" style=\"color:#393A34\">(</span>V<span class=\"token\" style=\"color:#393A34\">(</span>g<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">$</span>pid_type<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> col <span class=\"token\" style=\"color:#393A34\">=</span> col<span class=\"token\" style=\"color:#393A34\">,</span> bty <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;n&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span> pch<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span> <span class=\"token\" style=\"color:#393A34\">,</span> pt.cex <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">3</span><span class=\"token\" style=\"color:#393A34\">,</span> cex <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span> text.col<span class=\"token\" style=\"color:#393A34\">=</span>col <span class=\"token\" style=\"color:#393A34\">,</span> horiz <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">FALSE</span><span class=\"token\" style=\"color:#393A34\">,</span> inset <span class=\"token\" style=\"color:#393A34\">=</span> c<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0.1</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">0.1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><h2>Generate resource lists</h2>\n<p>We can generate a list of the datasets in APA format. </p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[ ]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">ids <span class=\"token\" style=\"color:#393A34\">&lt;-</span> substring<span class=\"token\" style=\"color:#393A34\">(</span>datasets<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">17</span><span class=\"token\" style=\"color:#393A34\">)</span>\nids <span class=\"token\" style=\"color:#393A34\">&lt;-</span> paste<span class=\"token\" style=\"color:#393A34\">(</span>ids<span class=\"token\" style=\"color:#393A34\">,</span> collapse <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;,&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nurl <span class=\"token\" style=\"color:#393A34\">&lt;-</span> paste<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;https://api.datacite.org/dois?style=apa&amp;page[size]=250&amp;sort=created&amp;ids=&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> ids<span class=\"token\" style=\"color:#393A34\">,</span> sep <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nresponse <span class=\"token\" style=\"color:#393A34\">&lt;-</span> GET<span class=\"token\" style=\"color:#393A34\">(</span>url<span class=\"token\" style=\"color:#393A34\">,</span> accept<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;text/x-bibliography&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndisplay_markdown<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;## Datasets&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndisplay_markdown<span class=\"token\" style=\"color:#393A34\">(</span>content<span class=\"token\" style=\"color:#393A34\">(</span>response<span class=\"token\" style=\"color:#393A34\">,</span> as <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;text&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-gZMcBi gmeReZ\"><p>We can also generate a list of all of the publications that were related to these items. </p></div></div><div class=\"sc-dnqmqq iXBJUB\"><div class=\"sc-bZQynM ivRWoJ\"><div class=\"sc-bxivhb hjplrr\">[ ]</div><pre class=\"sc-EHOje jvzENE input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">ids <span class=\"token\" style=\"color:#393A34\">&lt;-</span> references<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span>\nids <span class=\"token\" style=\"color:#393A34\">&lt;-</span> paste<span class=\"token\" style=\"color:#393A34\">(</span>ids<span class=\"token\" style=\"color:#393A34\">,</span> collapse <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;,&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nurl <span class=\"token\" style=\"color:#393A34\">&lt;-</span> paste<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;https://api.datacite.org/dois?style=apa&amp;page[size]=250&amp;sort=created&amp;ids=&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> ids<span class=\"token\" style=\"color:#393A34\">,</span> sep <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nresponse <span class=\"token\" style=\"color:#393A34\">&lt;-</span> GET<span class=\"token\" style=\"color:#393A34\">(</span>url<span class=\"token\" style=\"color:#393A34\">,</span> accept<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;text/x-bibliography&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndisplay_markdown<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;## References&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndisplay_markdown<span class=\"token\" style=\"color:#393A34\">(</span>content<span class=\"token\" style=\"color:#393A34\">(</span>response<span class=\"token\" style=\"color:#393A34\">,</span> as <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;text&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>  </code></pre></div></div></div></div>","internal":{"content":"{\n  \"cells\": [\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"# PID Graph for datasets related to FREYA\\n\",\n        \"\\n\",\n        \"This notebook uses the [DataCite GraphQL API](https://api.datacite.org/graphql) to fetch all connections to a publication with a DataCite DOI.\\n\",\n        \"\\n\",\n        \"## Prepare the R GraphQl client\\n\",\n        \"Load necessary libraries and set up the API endpoint.\"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"library(\\\"httr\\\")\\n\",\n        \"library(\\\"ghql\\\")\\n\",\n        \"library(\\\"jsonlite\\\")\\n\",\n        \"library(\\\"IRdisplay\\\")\\n\",\n        \"library(\\\"dplyr\\\")\\n\",\n        \"library(\\\"purrr\\\")\\n\",\n        \"library(\\\"igraph\\\")\\n\",\n        \"\\n\",\n        \"cli <- GraphqlClient$new(\\n\",\n        \"  url = \\\"https://api.datacite.org/graphql\\\"\\n\",\n        \")\\n\",\n        \"qry <- Query$new()\"\n      ],\n      \"outputs\": [],\n      \"execution_count\": 66,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"## Generate the GraphQL query\\n\",\n        \"In this query, we are looking through all DataCite DOIs that are assigned to datasets and finding those that include the FREYA grant number within a funding reference. \\n\",\n        \"\\n\",\n        \"Then for each of those datasets, we're asking for:\\n\",\n        \"\\n\",\n        \"1. identifiers for the creators (in this case ORCID IDs)\\n\",\n        \"2. identifiers for items related to that dataset (citations, versions, etc.)\\n\",\n        \"3. identifiers for any funders related to that dataset\\n\",\n        \"\\n\",\n        \"In this example, we already know that the datasets will have the EC as a related funder, but pulling in the `funderIdentifier` will allow us to plot that information as part of our graph.\"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"query <- '{\\n\",\n        \"  datasets(query: \\\"fundingReferences.awardNumber:777523\\\") {\\n\",\n        \"    totalCount\\n\",\n        \"    nodes {\\n\",\n        \"      id\\n\",\n        \"      creators {\\n\",\n        \"        id\\n\",\n        \"      }\\n\",\n        \"      publications {\\n\",\n        \"        nodes {\\n\",\n        \"          id\\n\",\n        \"        }\\n\",\n        \"      }\\n\",\n        \"      datasets {\\n\",\n        \"        nodes {\\n\",\n        \"          id\\n\",\n        \"        }\\n\",\n        \"      }\\n\",\n        \"      fundingReferences {\\n\",\n        \"        funderIdentifier\\n\",\n        \"      }\\n\",\n        \"    }\\n\",\n        \"  }\\n\",\n        \"}'\"\n      ],\n      \"outputs\": [],\n      \"execution_count\": 67,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"## Run the query\\n\",\n        \"We'll run the query and process the JSON response it returns.\"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"qry$query('getdata', query)\\n\",\n        \"data <- fromJSON(cli$exec(qry$queries$getdata))\"\n      ],\n      \"outputs\": [],\n      \"execution_count\": 68,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"## Display the number of datasets\\n\",\n        \"This step is just to check our work. We already know there should be only 2 matching datasets (as of 6 June 2019 when this notebook was first created). \"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"display_json(data$data$datasets$totalCount)\"\n      ],\n      \"outputs\": [\n        {\n          \"output_type\": \"display_data\",\n          \"data\": {\n            \"application/json\": 2\n          },\n          \"metadata\": {}\n        }\n      ],\n      \"execution_count\": 69,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"Now let's prepare the data frame. We're defining what all of the nodes are for our graph. \"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"datasets <- data.frame(id=map(data$data$datasets$nodes$id, ~ discard(.x, ~ is.na(.x))), pid_type=c('dataset'))\\n\",\n        \"researchers <- data.frame(id=bind_rows(data$data$datasets$nodes$creators)[,1], pid_type=c('researcher'))\\n\",\n        \"references <- data.frame(id=bind_rows(map(data$data$datasets$nodes$publications$nodes$id, ~ discard(.x, ~ is.na(.x))), pid_type=c('publication')))\\n\",\n        \"dataset_references <- data.frame(id=bind_rows(map(data$data$datasets$nodes$datasets$nodes$id, ~ discard(.x, ~ is.na(.x))), pid_type=c('dataset')))\\n\",\n        \"funders <- data.frame(id=bind_rows(data$data$datasets$nodes$fundingReferences)[,1], pid_type=c('funder'))\\n\",\n        \"nodes <- unique(rbind(datasets, researchers, references, dataset_references, funders))\\n\",\n        \"\\n\",\n        \"nodes <- nodes %>% filter(!is.na(as.character(id))) %>% mutate(id = ifelse(startsWith(as.character(id), '10.'), paste('https://doi.org/', id, sep=''), as.character(id)))\\n\",\n        \"\\n\",\n        \"# remove duplicates\\n\",\n        \"nodes <- nodes %>% distinct(id, .keep_all = TRUE)\\n\",\n        \"nodes\"\n      ],\n      \"outputs\": [\n        {\n          \"output_type\": \"error\",\n          \"ename\": \"ERROR\",\n          \"evalue\": \"Error in data.frame(id = bind_rows(map(data$data$datasets$nodes$publications$nodes$id, : arguments imply differing number of rows: 0, 1\\n\",\n          \"traceback\": [\n            \"Error in data.frame(id = bind_rows(map(data$data$datasets$nodes$publications$nodes$id, : arguments imply differing number of rows: 0, 1\\nTraceback:\\n\",\n            \"1. data.frame(id = bind_rows(map(data$data$datasets$nodes$publications$nodes$id, \\n .     ~discard(.x, ~is.na(.x)))), pid_type = c(\\\"publication\\\"))\",\n            \"2. stop(gettextf(\\\"arguments imply differing number of rows: %s\\\", \\n .     paste(unique(nrows), collapse = \\\", \\\")), domain = NA)\"\n          ]\n        }\n      ],\n      \"execution_count\": 70,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"Then we define the edges for our graph. We loop through the nodes because each node could have multiple edges.\"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"edges <- data.frame(to=character(), from=character())\\n\",\n        \"nodes_with_creators <- bind_rows(data$data$datasets$nodes) %>% filter(lengths(creators) != 0)\\n\",\n        \"for (i in 1:nrow(nodes_with_creators)) {\\n\",\n        \"  row <- data.frame(to=unlist(nodes_with_creators[i,2]), from=nodes_with_creators[i,1])\\n\",\n        \"  edges <- unique(rbind(edges, row))\\n\",\n        \"}\\n\",\n        \"\\n\",\n        \"nodes_with_references <- bind_rows(data$data$datasets$nodes) %>% filter(lengths(relatedIdentifiers) != 0)\\n\",\n        \"for (i in 1:nrow(nodes_with_references)) {\\n\",\n        \"  row <- data.frame(to=unlist(nodes_with_references[i,3]), from=nodes_with_references[i,1])\\n\",\n        \"  edges <- unique(rbind(edges, row))\\n\",\n        \"}\\n\",\n        \"\\n\",\n        \"nodes_with_funding <- bind_rows(data$data$datasets$nodes) %>% filter(lengths(fundingReferences) != 0)\\n\",\n        \"for (i in 1:nrow(nodes_with_funding)) {\\n\",\n        \"  row <- data.frame(to=unlist(nodes_with_funding[i,4]), from=nodes_with_funding[i,1])\\n\",\n        \"  edges <- unique(rbind(edges, row))\\n\",\n        \"}\"\n      ],\n      \"outputs\": [],\n      \"execution_count\": null,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"## Generating the graph\\n\",\n        \"We're going to make sure that all of the DOIs we're receiving are being expressed as URLs. This will help us with de-duping and filtering in later steps.\"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"edges <- edges %>% filter(!is.na(as.character(to))) %>% mutate(to = ifelse(startsWith(as.character(to), '10.'), paste('https://doi.org/', to, sep=''), as.character(to)))\"\n      ],\n      \"outputs\": [],\n      \"execution_count\": null,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"Next we format the graph for display. Here are the formatting choices we're making. \\n\",\n        \"\\n\",\n        \"1. We're going to display only the unique edges and nodes. \\n\",\n        \"2. We're coloring datasets red, researchers green, publications blue, and funders yellow.\\n\",\n        \"3. We're making the nodes a nice size for viewing. \\n\",\n        \"4. This is not a directed graph (`relatedidentifiers` don't specify a relational direction), so we don't need to have any arrows. \"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"g <- graph_from_data_frame(d=unique(edges), vertices=unique(nodes))\\n\",\n        \"\\n\",\n        \"# Node colors\\n\",\n        \"col = c('#e45718','#fecf59','#48b1f4','#53c48c')\\n\",\n        \"V(g)[(V(g)$pid_type==\\\"publication\\\")]$color<-'#48b1f4'\\n\",\n        \"V(g)[(V(g)$pid_type==\\\"researcher\\\")]$color<-'#53c48c'\\n\",\n        \"V(g)[(V(g)$pid_type==\\\"funder\\\")]$color<-'#fecf59'\\n\",\n        \"V(g)[(V(g)$pid_type==\\\"dataset\\\")]$color<-'#e45718'\\n\",\n        \"\\n\",\n        \"V(g)$size <- 8\\n\",\n        \"E(g)$arrow.mode <- 0\\n\",\n        \"l <- layout_with_dh(g)\"\n      ],\n      \"outputs\": [],\n      \"execution_count\": null,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"And finally, we plot the actual graph. \"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"plot(g, vertex.label=NA, layout=l, arrow.mode=0)\\n\",\n        \"\\n\",\n        \"# Add a legend\\n\",\n        \"legend(\\\"bottomleft\\\", legend=levels(as.factor(V(g)$pid_type)), col = col, bty = \\\"n\\\", pch=20 , pt.cex = 3, cex = 1, text.col=col , horiz = FALSE, inset = c(0.1, -0.1))\"\n      ],\n      \"outputs\": [],\n      \"execution_count\": null,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"## Generate resource lists\\n\",\n        \"We can generate a list of the datasets in APA format. \"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"ids <- substring(datasets[,1], 17)\\n\",\n        \"ids <- paste(ids, collapse = ',')\\n\",\n        \"url <- paste('https://api.datacite.org/dois?style=apa&page[size]=250&sort=created&ids=', ids, sep = '')\\n\",\n        \"response <- GET(url, accept(\\\"text/x-bibliography\\\"))\\n\",\n        \"display_markdown('## Datasets')\\n\",\n        \"display_markdown(content(response, as = 'text'))\"\n      ],\n      \"outputs\": [],\n      \"execution_count\": null,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    },\n    {\n      \"cell_type\": \"markdown\",\n      \"source\": [\n        \"We can also generate a list of all of the publications that were related to these items. \"\n      ],\n      \"metadata\": {}\n    },\n    {\n      \"cell_type\": \"code\",\n      \"source\": [\n        \"ids <- references[,1]\\n\",\n        \"ids <- paste(ids, collapse = ',')\\n\",\n        \"url <- paste('https://api.datacite.org/dois?style=apa&page[size]=250&sort=created&ids=', ids, sep = '')\\n\",\n        \"response <- GET(url, accept(\\\"text/x-bibliography\\\"))\\n\",\n        \"display_markdown('## References')\\n\",\n        \"display_markdown(content(response, as = 'text'))  \"\n      ],\n      \"outputs\": [],\n      \"execution_count\": null,\n      \"metadata\": {\n        \"collapsed\": false,\n        \"outputHidden\": false,\n        \"inputHidden\": false\n      }\n    }\n  ],\n  \"metadata\": {\n    \"kernel_info\": {\n      \"name\": \"ir\"\n    },\n    \"language_info\": {\n      \"name\": \"R\",\n      \"codemirror_mode\": \"r\",\n      \"pygments_lexer\": \"r\",\n      \"mimetype\": \"text/x-r-source\",\n      \"file_extension\": \".r\",\n      \"version\": \"3.6.0\"\n    },\n    \"kernelspec\": {\n      \"name\": \"ir\",\n      \"language\": \"R\",\n      \"display_name\": \"R\"\n    },\n    \"nteract\": {\n      \"version\": \"0.14.3\"\n    }\n  },\n  \"nbformat\": 4,\n  \"nbformat_minor\": 0\n}"}}},"pageContext":{"slug":"/notebooks/pid-graph/r-grant-datasets/r-grant-datasets/"}}}